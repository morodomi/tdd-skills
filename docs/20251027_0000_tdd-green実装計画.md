# Laravel用tdd-green Skill 実装計画

**作成日時**: 2025-10-27 00:00
**対象**: templates/laravel/.claude/skills/tdd-green/

---

## ユーザーストーリー

**As a** Laravel開発者
**I want to** REDフェーズで作成したテストを通すための最小限の実装をしたい
**So that** TDDサイクルに従って、テストを通しながら段階的に機能を実装できる

---

## 受け入れ基準

### シナリオ1: tdd-green Skillが正しく発動する

**Given** ユーザーがLaravelプロジェクトで作業している
**And** REDフェーズでテストが作成済み
**When** 以下のいずれかの条件を満たす
  - ユーザーが「green」「実装」と言う
  - `/tdd-green` コマンドを実行する
  - REDフェーズが完了して次のフェーズへ進む
**Then** tdd-green Skillが自動的に読み込まれる
**And** テストを確認してから実装を開始する

### シナリオ2: 最小限の実装のみを行う

**Given** tdd-green Skillが発動している
**And** テストが失敗している
**When** Skillが実装を開始する
**Then** テストを通すための最小限のコードのみを実装する
**And** 過剰な機能追加を行わない
**And** リファクタリングはREFACTORフェーズに委ねる

### シナリオ3: テスト実行を促す

**Given** 実装が完了した
**When** ファイルを保存した後
**Then** テスト実行コマンドを提示する
**And** すべてのテストが通ることを確認するよう促す

### シナリオ4: 次フェーズを案内する

**Given** すべてのテストが通った
**When** GREENフェーズが完了した
**Then** REFACTORフェーズへの移行を案内する
**And** コード改善のタイミングであることを説明する

---

## 実装範囲

### 対象ファイル

新規作成:
- `templates/laravel/.claude/skills/tdd-green/SKILL.md` - tdd-green Skillの定義

### 対象外

- コード生成テンプレート（必要に応じて将来追加）
- スラッシュコマンド（後のフェーズで実装）
- 他のSkills

---

## アーキテクチャ設計

### ファイル構成

```
templates/laravel/.claude/skills/tdd-green/
└── SKILL.md                      # Skill定義
```

### SKILL.mdの構造

```yaml
---
name: tdd-green
description: GREENフェーズ用。REDフェーズで作成したテストを通すための最小限の実装のみを行う。ユーザーが「green」「実装」と言った時、REDフェーズ完了後、または /tdd-green コマンド実行時に使用。過剰な実装を防ぎ、テストを通すことに集中。
allowed-tools: Read, Write, Edit, Grep, Glob, Bash
---

# TDD GREEN Phase

[Skillの詳細内容]
```

### Skillの振る舞い

1. **発動時**
   - 作成済みのテストファイルを確認（tests/Feature/, tests/Unit/）
   - テストを実行してエラー内容を確認
   - PLAN.mdを参照して実装範囲を確認

2. **実装フェーズ**
   - テストエラーメッセージから必要な実装を判断
   - 最小限のコードのみを実装
   - 以下の順序で実装:
     1. モデル（必要な場合）
     2. マイグレーション（必要な場合）
     3. コントローラー
     4. ルート定義
     5. サービスクラス（必要な場合）

3. **実装の原則**
   - **最小限**: テストを通すための最低限のコードのみ
   - **単純**: 複雑なロジックは書かない
   - **べた書き許容**: DRYは気にしない（REFACTORフェーズで改善）
   - **早期リターン**: ハードコードも許容

4. **テスト実行フェーズ**
   - 実装後、テスト実行コマンドを提示
   - すべてのテストが通ることを確認するよう促す
   - 失敗した場合は追加実装を提案

5. **完了フェーズ**
   - 実装したファイル一覧を表示
   - 次のフェーズ（REFACTOR）を案内
   - リファクタリングの重要性を説明

---

## テストケース一覧

このプロジェクトはSkillsの実装なので、テストは手動確認になります。

### 手動テストケース

1. **Skill発動テスト**
   - 条件: Laravelプロジェクトで「green」と発言
   - 期待: tdd-green Skillが読み込まれる

2. **テスト確認テスト**
   - 条件: Skill発動後
   - 期待: tests/配下のテストファイルが確認される

3. **最小実装テスト**
   - 条件: 実装を依頼
   - 期待: 最小限のコードのみが実装される
   - 期待: 過剰な機能追加がない

4. **Bash許可テスト**
   - 条件: テスト実行を依頼
   - 期待: `php artisan test` が実行できる
   - 期待: マイグレーション実行ができる

5. **テスト実行案内テスト**
   - 条件: 実装完了後
   - 期待: テスト実行コマンドが提示される

6. **次フェーズ案内テスト**
   - 条件: すべてのテストが通った
   - 期待: REFACTORフェーズへの移行が案内される

---

## 見積もり

- SKILL.md作成: 60分
- 動作確認（手動テスト）: 30分
- ドキュメント更新: 15分

**合計**: 約1時間45分

---

## 依存関係

### 前提条件
- REDフェーズが完了していること
- tests/配下にテストファイルが存在すること
- PLAN.mdが存在すること（実装範囲の参照用）

### 今後の依存
- `tdd-refactor` Skillが、このフェーズで作成した実装を改善する

---

## リスク

### リスク1: 過剰な実装をしてしまう

**発生条件**: Claude Codeが「良いコード」を書こうとする
**対策**: Skillで明確に「最小限」「べた書き許容」「ハードコードOK」を強調

### リスク2: テストが通らない

**発生条件**: 実装が不完全、またはテストが間違っている
**対策**: エラーメッセージを確認して段階的に修正

### リスク3: マイグレーション実行のタイミング

**発生条件**: マイグレーション実行前にテストを実行してエラー
**対策**: マイグレーションが必要な場合は先に実行することを明記

---

## 次のステップ

1. [完了] INIT（要件定義）
2. [完了] PLAN作成（このドキュメント）
3. [次] PLAN REVIEW（ユーザー承認）
4. [未] RED（手動テストケース作成）
5. [未] GREEN（SKILL.md実装）
6. [未] REFACTOR（内容の洗練）
7. [未] REVIEW（動作確認）
8. [未] DOC（README更新）
9. [未] COMMIT

---

*作成日時: 2025-10-27 00:00*
*次のフェーズ: PLAN REVIEW*
