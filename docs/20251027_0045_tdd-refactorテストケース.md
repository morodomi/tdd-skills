# Laravel用tdd-refactor Skill テストケース

**作成日時**: 2025-10-27 00:45
**対象**: templates/laravel/.claude/skills/tdd-refactor/
**テストタイプ**: 手動テスト

---

## テスト環境

- **Claude Code**: 最新版
- **テスト対象プロジェクト**: 既存のLaravelプロジェクト
- **前提条件**:
  - tdd-refactor Skillがインストール済み
  - `.claude/skills/tdd-refactor/SKILL.md` が存在
  - GREENフェーズで実装が完了している
  - すべてのテストが通っている状態

---

## テストケース一覧

### TC-01: Skill発動テスト（キーワード）

**目的**: ユーザーが「refactor」と発言した際にtdd-refactor Skillが正しく発動することを確認

**前提条件**:
- Laravelプロジェクトディレクトリにいる
- Claude Codeが起動している
- GREENフェーズで実装が完了している

**実施手順**:
1. Claude Codeで新しいセッションを開始
2. 「refactor」とメッセージを送信
3. Skillの読み込みログを確認

**期待結果**:
- tdd-refactor Skillが自動的に読み込まれる
- Claude Codeが「REFACTORフェーズを開始します」等のメッセージを返す
- 「テストを維持しながらリファクタリングします」等の説明がある
- テストを実行する動作が見られる

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-02: 発動キーワードバリエーションテスト

**目的**: 複数のキーワードでSkillが発動することを確認

**前提条件**:
- Laravelプロジェクトディレクトリにいる
- Claude Codeが起動している
- GREENフェーズで実装が完了している

**実施手順**:
1. 新しいセッションで「リファクタリング」と発言 → Skill発動確認
2. 新しいセッションで「refactor」と発言 → Skill発動確認

**期待結果**:
- すべてのキーワードでtdd-refactor Skillが発動する
- 発動の挙動が一貫している

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-03: GREENフェーズ完了後の自動発動テスト

**目的**: GREENフェーズ完了後、自然にREFACTORフェーズに移行できることを確認

**前提条件**:
- tdd-green Skillが発動している
- 実装が完了し、テストが通っている

**実施手順**:
1. tdd-green Skillで実装を完了
2. GREENフェーズを完了
3. 「次のフェーズに進んで」等と発言
4. tdd-refactor Skillが発動するか確認

**期待結果**:
- GREENフェーズ完了後、tdd-refactor Skillが自動的に発動
- または、REFACTORフェーズへの移行を促すメッセージが表示される

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-04: 事前テスト確認テスト

**目的**: Skillが発動時にすべてのテストが通っていることを確認することを確認

**前提条件**:
- tdd-refactor Skillが発動している

**実施手順**:
1. Skillが発動したら、テスト実行動作を観察
2. テスト結果の確認動作を観察

**期待結果**:
- `php artisan test` が実行される
- すべてのテストが通っていることを確認する
- テストが失敗している場合はREFACTORフェーズを開始しない

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-05: DRY原則適用テスト

**目的**: 重複コードが適切に共通化されることを確認

**前提条件**:
- tdd-refactor Skillが発動している
- 重複コードが存在する

**実施手順**:
1. Skillにリファクタリングを依頼
2. 重複コードが共通化されるか確認
3. 変更後にテストが実行されるか確認

**期待結果**:
- 重複コードが抽出されて共通メソッドになる
- 各変更後にテストが実行される
- テストが通り続ける

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-06: 定数化テスト

**目的**: マジックナンバーや文字列が適切に定数化されることを確認

**前提条件**:
- tdd-refactor Skillが発動している
- マジックナンバーや文字列が存在する

**実施手順**:
1. Skillにリファクタリングを依頼
2. マジックナンバー/文字列が定数化されるか確認

**期待結果**:
- マジックナンバーが定数に置き換えられる
- 文字列リテラルが定数に置き換えられる
- 定数名が適切（SCREAMING_SNAKE_CASE）

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-07: メソッド分割テスト

**目的**: 長いメソッドが適切に分割されることを確認

**前提条件**:
- tdd-refactor Skillが発動している
- 長いメソッドが存在する

**実施手順**:
1. Skillにリファクタリングを依頼
2. 長いメソッドが分割されるか確認

**期待結果**:
- 長いメソッドが適切な単位で分割される
- 分割されたメソッド名が適切
- 各メソッドが単一責任を持つ

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-08: テスト維持テスト

**目的**: リファクタリング中にテストが維持されることを確認

**前提条件**:
- tdd-refactor Skillが発動している
- リファクタリング中

**実施手順**:
1. 各リファクタリング変更を観察
2. 変更後にテストが実行されるか確認

**期待結果**:
- 各変更後に `php artisan test` が実行される
- テストが通り続ける
- テストが失敗した場合は変更が戻される

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-09: PHPStan実行テスト

**目的**: リファクタリング完了後にPHPStanが実行されることを確認

**前提条件**:
- tdd-refactor Skillが発動している
- リファクタリングが完了した

**実施手順**:
1. リファクタリング完了後のメッセージを確認
2. PHPStan実行を観察

**期待結果**:
- `vendor/bin/phpstan analyse` が実行される
- Level 8で実行される
- エラー0件を目指す
- エラーがある場合は修正される

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-10: Laravel Pint実行テスト

**目的**: リファクタリング完了後にLaravel Pintが実行されることを確認

**前提条件**:
- tdd-refactor Skillが発動している
- リファクタリングが完了した

**実施手順**:
1. リファクタリング完了後のメッセージを確認
2. Laravel Pint実行を観察

**期待結果**:
- `vendor/bin/pint` が実行される
- コードが整形される
- PSR-12に準拠する

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-11: テストカバレッジ確認テスト

**目的**: リファクタリング完了後にテストカバレッジが確認されることを確認

**前提条件**:
- tdd-refactor Skillが発動している
- リファクタリングが完了した

**実施手順**:
1. リファクタリング完了後のメッセージを確認
2. テストカバレッジ確認を観察

**期待結果**:
- `php artisan test --coverage` が実行される
- カバレッジが90%以上であることを確認
- 90%未満の場合は警告が表示される

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-12: リファクタリング内容サマリー表示テスト

**目的**: 完了フェーズでリファクタリング内容のサマリーが表示されることを確認

**前提条件**:
- tdd-refactor Skillが発動している
- リファクタリングが完了した

**実施手順**:
1. 完了メッセージを確認
2. リファクタリング内容が表示されるか確認

**期待結果**:
- 実施したリファクタリング内容が一覧表示される
- 変更したファイルが表示される
- 改善内容（DRY、定数化、メソッド分割等）が明示される

**実際の結果**:
[実施時に記録]

**リファクタリング内容**:
[記録]

**判定**: [合格/不合格]

---

### TC-13: 品質チェック結果表示テスト

**目的**: 完了フェーズで品質チェック結果が表示されることを確認

**前提条件**:
- tdd-refactor Skillが発動している
- リファクタリングが完了した

**実施手順**:
1. 完了メッセージを確認
2. 品質チェック結果が表示されるか確認

**期待結果**:
- PHPStan結果が表示される（Level 8、エラー件数）
- Laravel Pint結果が表示される
- テストカバレッジが表示される（%）
- 品質基準を満たしているか判定される

**実際の結果**:
[実施時に記録]

**品質チェック結果**:
- PHPStan: [記録]
- Laravel Pint: [記録]
- テストカバレッジ: [記録]

**判定**: [合格/不合格]

---

### TC-14: 次フェーズ案内テスト

**目的**: REFACTORフェーズ完了後、REVIEWフェーズへの移行を適切に案内することを確認

**前提条件**:
- tdd-refactor Skillが発動している
- リファクタリングが完了した
- 品質チェックが完了した

**実施手順**:
1. 完了メッセージで次のステップ案内を確認

**期待結果**:
- 次のフェーズ（REVIEW）について明示される
- REVIEWフェーズで何をするか（品質検証）が説明される
- TDDワークフローの現在位置が表示される

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

### TC-15: 過剰リファクタリング防止テスト

**目的**: 過剰なリファクタリングを行わないことを確認

**前提条件**:
- tdd-refactor Skillが発動している

**実施手順**:
1. 「全体的にアーキテクチャを見直して」と依頼
2. Skillの応答を確認

**期待結果**:
- 「REFACTORフェーズでは必要最小限の改善のみ」と説明される
- 大規模な変更は別のTDDサイクルで行うよう促される
- テストが通ればリファクタリング完了と判断される

**実際の結果**:
[実施時に記録]

**判定**: [合格/不合格]

---

## テスト実施記録

**実施日**: [未実施]
**実施者**: [名前]
**使用環境**:
- Claude Code バージョン:
- Laravelプロジェクト:
- PHPバージョン:
- PHPStanバージョン:

### 総合結果

| テストケース | 判定 | 備考 |
|------------|------|------|
| TC-01: Skill発動（キーワード） | [未実施] | |
| TC-02: 発動キーワードバリエーション | [未実施] | |
| TC-03: GREENフェーズ完了後の自動発動 | [未実施] | |
| TC-04: 事前テスト確認 | [未実施] | |
| TC-05: DRY原則適用 | [未実施] | |
| TC-06: 定数化 | [未実施] | |
| TC-07: メソッド分割 | [未実施] | |
| TC-08: テスト維持 | [未実施] | |
| TC-09: PHPStan実行 | [未実施] | |
| TC-10: Laravel Pint実行 | [未実施] | |
| TC-11: テストカバレッジ確認 | [未実施] | |
| TC-12: リファクタリング内容サマリー表示 | [未実施] | |
| TC-13: 品質チェック結果表示 | [未実施] | |
| TC-14: 次フェーズ案内 | [未実施] | |
| TC-15: 過剰リファクタリング防止 | [未実施] | |

**合格数**: 0/15
**不合格数**: 0/15
**未実施**: 15/15

**総合判定**: [未実施]

---

## 不具合記録

### 不具合-01: [タイトル]
**発生テストケース**:
**症状**:
**再現手順**:
**期待される動作**:
**実際の動作**:
**対応**:

---

## 備考

- テストは実装完了後（GREENフェーズ後）に実施する
- すべてのテストが合格するまでREVIEWフェーズに進まない
- 不合格の場合は実装を修正してテストを再実施
- 特にTC-08（テスト維持）とTC-09～11（品質チェック）は重要

---

*作成日時: 2025-10-27 00:45*
*次のフェーズ: GREEN（実装）*
