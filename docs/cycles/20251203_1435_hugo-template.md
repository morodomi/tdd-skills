---
feature: framework-templates
cycle: hugo-template-001
phase: DONE
created: 2025-12-03 14:35
updated: 2025-12-03 15:45
---

# Hugo用テンプレート作成

## やりたいこと

Hugo（Static Site Generator）プロジェクト用の ClaudeSkills TDD テンプレートを作成する。

**背景**:
- Hugo を使った静的サイト生成プロジェクトに TDD 環境を導入したい
- コンテンツ作成、テーマ開発、ビルド検証のワークフローを整備
- Hugo 固有のコマンド（hugo server, hugo build）に対応

---

## Scope Definition

### 今回実装する範囲

- [x] `templates/hugo/` ディレクトリ作成
- [x] `templates/hugo/install.sh` 作成
- [x] `templates/hugo/CLAUDE.md.template` 作成
- [x] `templates/hugo/agent_docs/` 作成
  - [x] content_guide.md（コンテンツ作成ガイド）
  - [x] theme_development.md（テーマ開発ガイド）
  - [x] commands.md（Hugo コマンド一覧）
- [x] `templates/hugo/.claude/skills/` 作成（TDD各フェーズ）
- [x] `templates/hugo/.htmltest.yml` 作成（リンク検証設定）

### 今回実装しない範囲

- Gatsby テンプレート（別サイクル）
- Next.js SSG テンプレート（別サイクル）
- Hugo テーマの自動テスト（将来検討）

### 変更予定ファイル

```
templates/hugo/
├── install.sh
├── CLAUDE.md.template
├── agent_docs/
│   ├── content_guide.md
│   ├── theme_development.md
│   └── commands.md
└── .claude/skills/
    ├── tdd-init/SKILL.md
    ├── tdd-plan/SKILL.md
    ├── tdd-red/SKILL.md
    ├── tdd-green/SKILL.md
    ├── tdd-refactor/SKILL.md
    ├── tdd-review/SKILL.md
    ├── tdd-commit/SKILL.md
    └── ux-design/SKILL.md
```

計: 約15ファイル

---

## Context & Dependencies

### 参照テンプレート

- `templates/flask/` - Python用テンプレートの構造参考
- `templates/generic/` - 汎用テンプレートの構造参考
- `templates/_common/agent_docs/tdd_workflow.md` - 共通TDDワークフロー

### Hugo プロジェクト特性

| 特性 | 内容 |
|------|------|
| 言語 | Go Template + Markdown |
| ビルド | hugo build |
| 開発サーバー | hugo server |
| コンテンツ | content/ ディレクトリ |
| テーマ | themes/ または layouts/ |
| 設定 | hugo.toml / config.toml |

### Hugo コマンド

| コマンド | 用途 |
|---------|------|
| `hugo server` | 開発サーバー起動（ライブリロード） |
| `hugo server -D` | ドラフト含めて起動 |
| `hugo build` | 本番ビルド（public/） |
| `hugo new content/posts/xxx.md` | 新規コンテンツ作成 |
| `hugo new theme <name>` | 新規テーマ作成 |

### プロジェクト検出条件

Hugo プロジェクトの識別:
- `hugo.toml` または `config.toml` の存在
- `content/` ディレクトリの存在
- `layouts/` または `themes/` ディレクトリの存在

---

## Test List

### 実装予定（TODO）

（なし）

### 実装中（WIP）

（なし）

### 実装中に気づいた追加テスト（DISCOVERED）

- [x] DISC-01: tdd-green, tdd-refactor, tdd-commit も Hugo 固有にカスタマイズ
- [x] DISC-02: tdd_workflow.md を agent_docs/ に含める（Hugo向けTDDワークフロー）
- [x] DISC-03: tdd-red SKILL.md を Hugo 向け（ページ構造定義）に変更

### 完了（DONE）

- [x] TC-01: templates/hugo/ ディレクトリが存在する
- [x] TC-02: install.sh が Hugo プロジェクトを検出できる
- [x] TC-03: install.sh が hugo/htmltest コマンドの存在を確認できる
- [x] TC-04: CLAUDE.md.template が100行以下である（約95行）
- [x] TC-05: agent_docs/ に3ファイルが存在する
- [x] TC-06: .claude/skills/ に全TDDフェーズが存在する
- [x] TC-07: tdd-init SKILL.md が Hugo 固有のチェックを含む
- [x] TC-08: tdd-review SKILL.md が hugo build + htmltest を実行する

---

## Implementation Notes

### Hugo プロジェクト構造（想定）

```
hugo-project/
├── archetypes/
│   └── default.md
├── assets/
├── content/
│   ├── posts/
│   └── pages/
├── data/
├── layouts/
│   ├── _default/
│   ├── partials/
│   └── shortcodes/
├── static/
├── themes/
├── hugo.toml
└── README.md
```

### Hugo 向け TDD の考え方

Hugo は静的サイトジェネレーターのため、従来のユニットテストとは異なるアプローチが必要:

| フェーズ | Hugo での解釈 |
|---------|--------------|
| RED | 期待するページ構造・出力を定義 |
| GREEN | コンテンツ・テンプレート作成 |
| REFACTOR | テンプレート整理、パーシャル分割 |
| REVIEW | ビルド確認、リンク検証、アクセシビリティ |

### 品質チェック（Hugo用）- 決定事項

**採用**: B（ビルド + リンク検証）

| 項目 | ツール/コマンド | 必須 |
|------|----------------|------|
| ビルド成功 | `hugo build --gc --minify` | Yes |
| リンク検証 | `htmltest ./public` | Yes |
| アクセシビリティ | pa11y, axe-core | No（将来対応） |
| パフォーマンス | Lighthouse CLI | No（将来対応） |

### Hugo TDD フェーズ解釈 - 決定事項

| フェーズ | 内容 |
|---------|------|
| RED | 期待するページ・セクション構造を定義 |
| GREEN | content/ にMarkdown作成、layouts/ にテンプレート作成 |
| REFACTOR | パーシャル分割、ショートコード整理 |
| REVIEW | `hugo build` 成功確認、`htmltest` リンク検証 |

---

## PLAN: 詳細設計

### 1. install.sh

**検出ロジック**:
```bash
# Hugo プロジェクト検出
if [ -f "hugo.toml" ] || [ -f "config.toml" ] || [ -f "config.yaml" ]; then
    IS_HUGO=true
fi

# content/ ディレクトリ確認
if [ -d "content" ]; then
    IS_HUGO=true
fi
```

**hugo コマンド確認**:
```bash
if ! command -v hugo &> /dev/null; then
    echo "警告: hugo コマンドが見つかりません"
    echo "インストール: https://gohugo.io/installation/"
fi
```

**htmltest インストール案内**:
```bash
if ! command -v htmltest &> /dev/null; then
    echo "リンク検証には htmltest が必要です"
    echo "インストール: go install github.com/wjdp/htmltest@latest"
    echo "または: brew install htmltest"
fi
```

**コピー対象**:
- .claude/skills/ (TDD各フェーズ)
- agent_docs/ (Hugo固有)
- CLAUDE.md.template → CLAUDE.md
- .htmltest.yml（リンク検証設定）

### 2. CLAUDE.md.template（約100行）

```markdown
# ${PROJECT_NAME}

## Overview
[サイトの目的]

## Tech Stack
- Generator: Hugo
- Template: Go Template
- Content: Markdown
- Build: hugo build
- Link Check: htmltest

## Quick Commands
hugo server -D              # 開発サーバー（ドラフト含む）
hugo build --gc --minify    # 本番ビルド
htmltest ./public           # リンク検証
hugo new content/posts/xxx.md  # 新規記事

## TDD Workflow
INIT → PLAN → RED → GREEN → REFACTOR → REVIEW → COMMIT

| フェーズ | Hugo での内容 |
|---------|--------------|
| RED | 期待するページ構造を定義 |
| GREEN | content/, layouts/ 作成 |
| REFACTOR | パーシャル分割 |
| REVIEW | hugo build + htmltest |

詳細: agent_docs/tdd_workflow.md

## Documentation
- agent_docs/content_guide.md
- agent_docs/theme_development.md
- agent_docs/commands.md
```

### 3. agent_docs/content_guide.md

**内容**:
- Front matter の書き方
- セクション構造
- ショートコード使用法
- 画像・アセット管理
- ドラフト管理

**例**:
```markdown
---
title: "記事タイトル"
date: 2025-12-03
draft: false
tags: ["hugo", "tutorial"]
categories: ["development"]
---

## 本文

{{< figure src="/images/example.png" alt="説明" >}}
```

### 4. agent_docs/theme_development.md

**内容**:
- layouts/ 構造
- Base template と Block
- Partials 設計
- ショートコード作成
- CSS/JS アセット管理

**例**:
```
layouts/
├── _default/
│   ├── baseof.html      # ベーステンプレート
│   ├── list.html        # 一覧ページ
│   └── single.html      # 個別ページ
├── partials/
│   ├── header.html
│   ├── footer.html
│   └── meta.html
└── shortcodes/
    └── notice.html
```

### 5. agent_docs/commands.md

```bash
# 開発
hugo server              # 開発サーバー
hugo server -D           # ドラフト含む
hugo server --bind 0.0.0.0  # 外部アクセス許可

# ビルド
hugo build               # 基本ビルド
hugo build --gc --minify # 本番ビルド（最適化）
hugo build -D            # ドラフト含む

# コンテンツ作成
hugo new content/posts/my-post.md
hugo new content/pages/about.md

# リンク検証
htmltest ./public        # リンクチェック
htmltest --conf .htmltest.yml ./public

# 情報確認
hugo version
hugo list all            # 全コンテンツ一覧
hugo list drafts         # ドラフト一覧
```

### 6. .htmltest.yml（新規）

```yaml
DirectoryPath: "public"
CheckExternal: false      # 外部リンクはスキップ（高速化）
CheckInternal: true
IgnoreDirs:
  - "tags"
  - "categories"
IgnoreURLs:
  - "localhost"
  - "127.0.0.1"
```

### 7. .claude/skills/ 変更点

**tdd-init**: Hugo プロジェクト検出
```bash
# hugo.toml / config.toml の存在確認
# content/ ディレクトリの存在確認
```

**tdd-red**: Hugo 向け解釈
- 期待するページ構造を Markdown で定義
- セクション構造の設計

**tdd-green**: コンテンツ・テンプレート作成
- content/*.md 作成
- layouts/*.html 作成

**tdd-review**: Hugo 品質チェック
```bash
hugo build --gc --minify
htmltest ./public
```

### 8. 実装順序

1. ディレクトリ構造作成
2. agent_docs/ 作成（content_guide, theme_development, commands）
3. CLAUDE.md.template 作成
4. .htmltest.yml 作成
5. .claude/skills/ をgenericからコピー＆Hugo対応に修正
6. install.sh 作成

---

## Progress Log

### 2025-12-03 14:35 - INIT phase
- TDDサイクルドキュメント作成
- スコープ定義完了
- Hugo 固有の TDD アプローチ検討
- テストリスト作成

### 2025-12-03 14:45 - PLAN phase
- 品質チェック方針決定: B（ビルド + リンク検証）
- Hugo TDD フェーズ解釈決定
- 詳細設計完了
  - install.sh 検出ロジック（hugo.toml, config.toml, content/）
  - CLAUDE.md.template 構造
  - agent_docs/ 内容設計（content_guide, theme_development, commands）
  - .htmltest.yml 設定
  - Skills 変更点特定
- 実装順序決定

### 2025-12-03 15:00 - GREEN phase
- templates/hugo/ ディレクトリ構造作成
- agent_docs/ 作成完了
  - content_guide.md（Front matter、セクション構造、ショートコード）
  - theme_development.md（layouts構造、Partials、Hugo Pipes）
  - commands.md（hugo server, build, htmltest コマンド）
- CLAUDE.md.template 作成（約95行）
- .htmltest.yml 作成（リンク検証設定）
- .claude/skills/ をgenericからコピー＆Hugo対応に修正
  - tdd-init: Hugo検出ロジック追加
  - tdd-review: hugo build + htmltest に変更
- install.sh 作成＆実行権限付与
- DISCOVERED追加: 他Skillsの Hugo対応、tdd-red変更

### 2025-12-03 15:30 - GREEN phase (DISCOVERED対応)
- DISC-01完了: tdd-green, tdd-refactor, tdd-commit を Hugo 固有にカスタマイズ
  - tdd-green: content/ + layouts/ 作成に変更
  - tdd-refactor: パーシャル分割、ショートコード整理に変更
  - tdd-commit: Hugo向け説明に更新
- DISC-02完了: tdd_workflow.md を agent_docs/ に作成
  - Hugo TDD 7フェーズ解説
  - コンテンツ作成フロー
  - テーマ開発フロー
  - テストリスト管理
- DISC-03完了: tdd-red を Hugo 向けに変更
  - テストコード作成 → ページ構造定義に変更
  - URL、ページタイプ、テンプレート定義

---

### 2025-12-03 15:45 - REVIEW phase
- テンプレート構造検証: 16ファイル確認
- install.sh 実行権限確認
- CLAUDE.md.template サイズ確認（120行）
- Hugo固有カスタマイズ確認（全Skillsに適用済み）

### 2025-12-03 15:45 - COMMIT phase
- Flask/Hugoテンプレート一括コミット
- コミットハッシュ: e24ad6e
- 変更ファイル数: 32件

---

## 完了ステータス

1. [完了] INIT（初期化）
2. [完了] PLAN（計画）
3. [スキップ] RED（テスト作成）- テンプレート作成のため
4. [完了] GREEN（実装）
5. [スキップ] REFACTOR（リファクタリング）- 新規作成のため不要
6. [完了] REVIEW（品質検証）
7. [完了] COMMIT（コミット）

**TDDサイクル完了**

---

*作成日時: 2025-12-03 14:35*
*完了日時: 2025-12-03 15:45*
