---
name: tdd-init
description: INITフェーズ用。新しい機能開発のTDDサイクルを開始する。ユーザーの「やりたいこと」から機能名を自動生成し、docs/YYYYMMDD_hhmm_<機能名>.mdを作成してINITセクションを記録。PLANフェーズへ誘導。ユーザーが「init」「初期化」「新機能」と言った時、または /tdd-init コマンド実行時に使用。
allowed-tools: Read, Write, Grep, Glob, Bash
---

# TDD INIT Phase

あなたは現在 **INITフェーズ** にいます。

## このフェーズの目的

新しい機能開発の**TDDサイクルを開始**することです。
適切な準備を行い、PLANフェーズに進むための土台を作ります。

## このフェーズでやること

- [ ] TDDサイクルの開始を宣言する
- [ ] ユーザーに「やりたいこと」を質問する
- [ ] 機能名を自動生成し、ユーザーに確認する
- [ ] `docs/YYYYMMDD_hhmm_<機能名>.md`を作成する
- [ ] INITセクションを記録する
- [ ] PLANフェーズへの移行を案内する

## このフェーズで絶対にやってはいけないこと

- 実装計画を詳細に作成すること（PLANフェーズで行う）
- テストコードを書くこと（REDフェーズで行う）
- 実装コードを書くこと（GREENフェーズで行う）
- 過剰な分析や設計（PLANフェーズで行う）

## ワークフロー

### 1. 準備フェーズ

まず、現在の状態を確認してください：

```bash
# プロジェクトがLaravelプロジェクトか確認
ls artisan 2>/dev/null && ls composer.json 2>/dev/null
```

または、Readツールで確認：
- artisanファイルを読み込めるか
- composer.jsonに"laravel/framework"が含まれているか

Laravelプロジェクトでない場合：
```
このSkillはLaravelプロジェクト用です。
現在のディレクトリがLaravelプロジェクトか確認してください。

確認方法:
- artisanファイルが存在するか（Read artisan）
- composer.jsonに"laravel/framework"があるか（Read composer.json）

Laravelプロジェクトのルートディレクトリに移動してから再度実行してください。
```

次に、既存のTDDサイクルが進行中でないか確認：

```bash
# 最新のTDDドキュメントを検索
ls -t docs/202*.md 2>/dev/null | head -1
```

**ドキュメントが存在する場合**：

最新ファイルを読み込み、ステータスを確認します。

```
⚠️ 既存のTDDサイクルが進行中の可能性があります。

最新のドキュメント: docs/20251028_1530_XXX.md

選択肢:
1. 既存のTDDサイクルを継続する（INITは不要）
2. 新しいサイクルを開始する（既存サイクルと並行開発）

どうしますか？
```

ユーザーが新しいサイクルを開始することを選択した場合のみ、次に進みます。

### 2. ディレクトリ準備フェーズ

docsディレクトリを準備します：

```bash
# ディレクトリの存在確認
ls -d docs 2>/dev/null
```

**ディレクトリが存在しない場合**:

```bash
# ディレクトリ作成
mkdir -p docs
```

成功メッセージ:
```
✓ docsディレクトリを作成しました。
```

**ディレクトリが既に存在する場合**:
```
✓ docsディレクトリは既に存在します。
```

### 3. 機能名決定と TDD ドキュメント作成フェーズ

#### ステップ1: やりたいことを質問

ユーザーに質問：
```
どんな機能を実装しますか？やりたいことを教えてください。

例:
- ユーザーがログインできるようにしたい
- 管理者が商品を登録できるようにする
- CSVで売上データをエクスポートしたい
```

#### ステップ2: 機能名を自動生成

ユーザーの回答から適切な機能名を生成します。

**機能名生成のガイドライン**:
- 簡潔で分かりやすい名前
- 10〜20文字程度
- 「〜機能」「〜追加」「〜実装」などの接尾辞を付ける

**生成例**:
| やりたいこと | 生成される機能名 |
|------------|----------------|
| ユーザーがログインできるようにしたい | ユーザーログイン機能 |
| 管理者が商品を登録できるようにする | 管理者商品登録機能 |
| CSVで売上データをエクスポートしたい | 売上データCSVエクスポート機能 |
| パスワードリセットメールを送信する | パスワードリセットメール送信機能 |

#### ステップ3: 機能名をユーザーに確認

生成した機能名を提案：
```
機能名を「[生成した機能名]」にしますか？

そのままで良ければ「はい」と入力してください。
変更する場合は、別の機能名を入力してください。
```

ユーザーが「はい」または確認した場合、次に進みます。
ユーザーが別の名前を入力した場合、その名前を使用します。

#### ステップ4: 現在日時を取得

```bash
# YYYYMMDD_hhmm 形式で日時を取得
date +"%Y%m%d_%H%M"
```

例: `20251028_1530`

#### ステップ5: ファイル名を生成

フォーマット: `docs/YYYYMMDD_hhmm_<機能名>.md`

例:
```
docs/20251028_1530_ユーザーログイン機能.md
docs/20251028_1545_管理者商品登録機能.md
docs/20251029_1000_売上データCSVエクスポート機能.md
```

#### ステップ6: TDDドキュメントを作成

Writeツールを使用してファイルを作成します。

**テンプレート内容**:
```markdown
# [機能名]

**作成日時**: YYYY-MM-DD HH:MM
**機能名**: [機能名]
**ステータス**: INIT完了

---

## INIT（要件定義）

### やりたいこと

[ユーザーが入力した「やりたいこと」]

### 背景

[空欄・PLANフェーズで記入]

### 要件

[空欄・PLANフェーズで記入]

### 目的

[空欄・PLANフェーズで記入]

### 対象範囲

[空欄・PLANフェーズで記入]

---

## PLAN（実装計画）

[tdd-planで追記]

---

## RED（テストケース）

[tdd-redで追記]

---

## GREEN（実装）

[tdd-greenで追記]

---

## REFACTOR（リファクタリング）

[tdd-refactorで追記]

---

## REVIEW（品質検証）

[tdd-reviewで追記]

---

## DOC（ドキュメント更新）

[手動で追記]

---

## COMMIT

[手動で追記]

---

## 次のステップ

1. [完了] INIT（要件定義）← 現在ここ
2. [次] PLAN（実装計画）
3. [ ] RED（テストケース）
4. [ ] GREEN（実装）
5. [ ] REFACTOR（リファクタリング）
6. [ ] REVIEW（品質検証）
7. [ ] DOC（ドキュメント更新）
8. [ ] COMMIT

---

*作成日時: YYYY-MM-DD HH:MM*
*次のフェーズ: PLAN*
```

成功メッセージ:
```
✓ TDDドキュメントを作成しました。

ファイル: docs/20251028_1530_ユーザーログイン機能.md
機能名: ユーザーログイン機能
開始日時: 2025-10-28 15:30
```

### 4. 完了フェーズ

INITフェーズが完了したことを伝え、PLANフェーズへ誘導します：

```
================================================================================
INITフェーズが完了しました
================================================================================

TDDサイクルの準備が整いました。

現在のTDDワークフロー:
[完了] INIT (初期化) ← 現在ここ
[次] PLAN (計画)
[ ] RED (テスト作成)
[ ] GREEN (実装)
[ ] REFACTOR (リファクタリング)
[ ] REVIEW (品質検証)
[ ] COMMIT (コミット)

================================================================================
次のステップ: PLANフェーズ
================================================================================

PLANフェーズでは、以下を行います：

1. **実装計画の作成**
   - 機能の詳細な仕様
   - アーキテクチャ設計
   - ファイル構成

2. **受け入れ基準の定義**
   - Given/When/Then形式
   - すべてのシナリオを網羅

3. **品質基準の確認**
   - テストカバレッジ: 90%以上
   - PHPStan: Level 8
   - その他の品質基準

4. **テストケース設計**
   - 各受け入れ基準に対応するテスト
   - エッジケースの洗い出し

================================================================================
自動遷移: 次のフェーズ（PLAN）に進みます
================================================================================

PLANフェーズを自動的に開始します...
```

完了メッセージを表示したら、Skillツールを使って`tdd-plan` Skillを起動してください。

## 制約の強制

このフェーズでは、`allowed-tools: Read, Write, Grep, Glob, Bash` が使用可能です。

**Read**: プロジェクトファイルの確認
**Write**: INIT.md作成、.gitkeep作成
**Grep**: ファイル検索
**Glob**: ファイルパターンマッチ
**Bash**: ディレクトリ作成、ファイル操作

もしユーザーが以下のような依頼をした場合は、**丁寧に拒否**してください：

- 「実装計画を作って」→ 「INITフェーズでは実装計画を作りません。PLANフェーズで詳細に作成します」
- 「テストを書いて」→ 「INITフェーズではテストを書きません。REDフェーズで作成します」
- 「実装して」→ 「INITフェーズでは実装しません。GREENフェーズで実装します」

## トラブルシューティング

### Laravelプロジェクトでない場合

```
エラー: このSkillはLaravelプロジェクト用です。

現在のディレクトリがLaravelプロジェクトか確認してください：
- artisanファイルが存在するか
- composer.jsonに"laravel/framework"があるか

Laravelプロジェクトのルートディレクトリに移動してから再度実行してください。
```

### 既存のTDDサイクルが進行中の場合

```
⚠️ 既存のTDDサイクルが進行中です。

以下のファイルが存在します:
- docs/tdd/PLAN.md

対応方法:
1. 既存のTDDサイクルを完了する（推奨）
2. 既存のファイルをバックアップする
   ```bash
   mv docs/tdd docs/tdd.backup.$(date +%Y%m%d_%H%M%S)
   ```
3. 既存のファイルを削除する（注意）
   ```bash
   rm -rf docs/tdd/*
   ```

どの方法を選択しますか？
```

### ディレクトリ作成に失敗した場合

```
エラー: docs/tddディレクトリの作成に失敗しました。

考えられる原因:
- 書き込み権限がない
- ディスク容量が不足している
- docsディレクトリが存在しない

対応方法:
1. 権限を確認
   ```bash
   ls -la docs/
   ```

2. 手動でディレクトリを作成
   ```bash
   mkdir -p docs/tdd
   ```

3. 権限を修正（必要に応じて）
   ```bash
   chmod 755 docs/
   ```
```

### 機能名が不明確な場合

```
機能名をより具体的に教えてください。

良い例:
- ユーザー認証機能
- 商品検索機能
- CSV出力機能

悪い例:
- 機能
- 新しいやつ
- あれ

具体的な機能名を入力してください：
```

## 参考情報

このSkillは、Laravel開発におけるTDDワークフローの**最初のフェーズ**です。

- 詳細なワークフロー: README.md参照
- プロジェクト設定: CLAUDE.md参照
- 次のフェーズ: tdd-plan Skill（計画）

### INITフェーズの重要性

INITフェーズは、TDDサイクルの**スタート地点**です：

- **準備**: 必要なディレクトリを用意
- **宣言**: 新しい機能開発の開始を明確化
- **記録**: 開始時点の情報を記録（オプション）
- **誘導**: PLANフェーズへスムーズに移行

「良いスタートが良い結果を生む」という原則に基づいています。

### INITフェーズのシンプルさ

INITフェーズは**意図的にシンプル**に設計されています：

- 詳細な分析や設計は行わない → PLANフェーズで実施
- テストは書かない → REDフェーズで実施
- 実装は行わない → GREENフェーズで実施

INITフェーズは「スタートを切る」だけです。
すぐにPLANフェーズに進んで、詳細な計画を立てましょう。

---

*このSkillはClaudeSkillsプロジェクトの一部です*
